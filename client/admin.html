<template name="admin">
    <div class="row">
        <div class="span12">
            <fieldset>
                <legend>Administration of {{domain}} domain</legend>
                {{> users_table}}
                <a class='drop btn btn-danger' href="#">Drop kudos :(</a>
                <a class='dropall btn btn-danger' href="#">Drop all kudos :'(</a>
            </fieldset>
        </div>
    </div>
</template>

<template name="users_table">
    <table class="table table-hover">
        <thead>
        <tr>
            <th>Name</th>
            <th>Email</th>
            <th>Sent / Received</th>
            <th>Currency</th>
            <th>Spendable</th>
            <th></th>
        </tr>
        </thead>
        <tbody>
        {{#each users}}
        {{> user_detail}}
        {{else}}
        <tr>
            <td colspan="6">No user in this domain.</td>
        </tr>
        {{/each}}
        </tbody>
    </table>
    <button class="resetUsers btn btn-info">Fix Counters</button>
</template>

<template name="user_detail">

    <tr class="user" objId="{{_id}}">
        <td>
            <strong>{{profile.name}}</strong>
            {{#if profile.admin}}
            <span class="label label-info">ADMIN</span>
            {{/if}}
        </td>
        {{#if editUser}}
        <td colspan="3">
            <form id="editUser_form" class="form-inline">
                {{#if notAdmin}}
                <button type="submit" class="give btn btn-success btn-small"><i class="icon-user icon-white"/> Give admin rights</button>
                {{/if}}
                <button type="submit" class="reset btn btn-warning btn-small"><i class="icon-fire icon-white"/> Burn counters</button>
                <button type="submit" class="remove btn btn-danger btn-small"><i class="icon-eye-open icon-white"/> Remove from domain</button>
            </form>
        </td>
        <td>
            <div class="input-prepend input-append">
                <button class="less_kudo btn">
                    <i class="icon-minus"/>
                </button>
                <input class="input-xmini" type="text" value="{{balance.spendable}}">
                <button class="more_kudo btn">
                    <i class="icon-plus"/>
                </button>
            </div>
        </td>
        <td><a class="exitEdit"><i class="icon-remove"/> Close</a></td>
        {{else}}
        <td>{{profile.email}}</td>
        <td>{{balance.sent}} / {{balance.received}}</td>
        <td>{{balance.currency}}</td>
        <td>{{balance.spendable}}</td>
        <td><a class="edit_user"><i class="icon-edit"/> Edit</a></td>
        {{/if}}
    </tr>
</template>